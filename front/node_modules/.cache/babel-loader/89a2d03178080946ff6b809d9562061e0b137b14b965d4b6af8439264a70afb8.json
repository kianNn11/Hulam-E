{"ast":null,"code":"import{useState,useEffect}from'react';import{useNavigate,useLocation}from'react-router-dom';import'./Checkout.css';import{ArrowLeftIcon}from'@heroicons/react/24/solid';import{useAuth}from'../../Context/AuthContext';import{rentalAPI}from'../../services/api';import AlertMessage from'../Common/AlertMessage';import SafeImage from'../Common/SafeImage';// Helper to check if item has real image data\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const hasRealImage=item=>{if(item.images_url&&Array.isArray(item.images_url)&&item.images_url.length>0)return true;if(item.image_url)return true;if(item.image)return true;return false;};const Checkout=()=>{const navigate=useNavigate();const location=useLocation();const{user,isLoggedIn}=useAuth();const[rentedItems,setRentedItems]=useState([]);const[showModal,setShowModal]=useState(false);const[loading,setLoading]=useState(false);const[alert,setAlert]=useState({show:false,type:'',message:''});// Form state\nconst[formData,setFormData]=useState({name:'',contactNumber:'',rentDuration:'',message:'',paymentMethod:'cash_on_delivery'});const showAlert=(type,message)=>{setAlert({show:true,type,message});setTimeout(()=>setAlert({show:false,type:'',message:''}),5000);};useEffect(()=>{var _location$state;const storedItems=JSON.parse(localStorage.getItem('rentedItems'))||[];// Check if there's a rental item passed via router state\nconst passedRental=(_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.rental;let initialItems=storedItems;if(passedRental){// Preserve all image fields for robust image display\nconst rentalItem={...passedRental,// keep all fields including images_url, image_url, image\nid:passedRental.id,name:passedRental.title,price:parseFloat(passedRental.price)};console.log('Adding rental item to cart:',rentalItem);// Debug log\n// Check if item is already in cart\nconst existingItemIndex=storedItems.findIndex(item=>item.id===rentalItem.id);if(existingItemIndex===-1){// Add new item to cart\ninitialItems=[...storedItems,rentalItem];localStorage.setItem('rentedItems',JSON.stringify(initialItems));console.log('Item added to cart. Total items:',initialItems.length);// Debug log\n}else{// Item already exists, just set the stored items\ninitialItems=storedItems;console.log('Item already in cart');// Debug log\n}}else{initialItems=storedItems;console.log('No rental passed via state. Using stored items:',storedItems.length);// Debug log\n}setRentedItems(initialItems);// Auto-fill user information if logged in\nif(isLoggedIn&&user){setFormData(prev=>({...prev,name:user.name||'',contactNumber:user.contact_number||''}));}// Fetch latest rental data for each item if missing image fields\nconst fetchMissingImages=async()=>{const updatedItems=await Promise.all(initialItems.map(async item=>{if(hasRealImage(item))return item;try{const res=await rentalAPI.getRental(item.id);console.log('Fetched rental from API:',res.data);// Merge the latest data into the item\nreturn{...item,...res.data.data};}catch(e){return item;}}));setRentedItems(updatedItems);localStorage.setItem('rentedItems',JSON.stringify(updatedItems));};if(initialItems.some(item=>!hasRealImage(item))){fetchMissingImages();}},[isLoggedIn,user,location.state]);const handleInputChange=e=>{const{name,value}=e.target;setFormData(prev=>({...prev,[name]:value}));};const handlePaymentMethodChange=e=>{setFormData(prev=>({...prev,paymentMethod:e.target.value}));};const removeItem=id=>{const updatedItems=rentedItems.filter(item=>item.id!==id);setRentedItems(updatedItems);localStorage.setItem('rentedItems',JSON.stringify(updatedItems));};const subTotal=rentedItems.reduce((acc,item)=>acc+item.price,0);const platformFee=10;const total=subTotal+platformFee;const handleCompleteRental=()=>{// Validate form\nif(!formData.name.trim()){showAlert('error','Please enter your name');return;}if(!formData.contactNumber.trim()){showAlert('error','Please enter your contact number');return;}if(!formData.rentDuration.trim()){showAlert('error','Please enter rent duration');return;}if(rentedItems.length===0){showAlert('error','No items in cart');return;}setShowModal(true);};const closeModal=()=>setShowModal(false);const confirmRental=async()=>{setLoading(true);try{const checkoutData={items:rentedItems.map(item=>({id:item.id,name:item.name,price:item.price})),renter_name:formData.name,renter_email:(user===null||user===void 0?void 0:user.email)||'guest@example.com',contact_number:formData.contactNumber,rent_duration:formData.rentDuration,message:formData.message,payment_method:formData.paymentMethod,renter_id:(user===null||user===void 0?void 0:user.id)||null};const response=await rentalAPI.checkout(checkoutData);if(response.data.success){const{data}=response.data;if(data.earnings_updated){showAlert('success',`Payment successful! Total: ₱${data.total_amount.toFixed(2)}\\n\\nYour earnings have been updated immediately. Check your earnings page to see the new balance.`);}else{showAlert('success',`Checkout successful! Total: ₱${data.total_amount.toFixed(2)}\\n\\nYour rental request has been sent. You'll earn money once the owner approves and completes the transaction.`);}// Clear cart and form\nsetRentedItems([]);localStorage.removeItem('rentedItems');setFormData({name:(user===null||user===void 0?void 0:user.name)||'',contactNumber:(user===null||user===void 0?void 0:user.contact_number)||'',rentDuration:'',message:'',paymentMethod:'cash_on_delivery'});setShowModal(false);// Navigate to earnings page if payment was completed\nsetTimeout(()=>{if(data.earnings_updated){navigate('/rentals');}else{navigate('/rentals');}},3000);}}catch(error){var _error$response,_error$response2,_error$response3;console.error('Checkout error:',error);// Handle different types of errors with detailed messages\nif(((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status)===403){var _error$restrictionDet;const data=error.response.data;// Handle suspended account with detailed restrictions\nif(data.error==='Account suspended'||((_error$restrictionDet=error.restrictionDetails)===null||_error$restrictionDet===void 0?void 0:_error$restrictionDet.type)==='suspended'){const details=error.restrictionDetails||data.restriction_details||{};const actionMessage=details.blocked_action||details.blockedAction||'checking out items';const contactInfo=details.contact_info||details.contactInfo||'Please contact support for assistance.';showAlert('error',`Account Suspended: You cannot perform this action (${actionMessage}). ${contactInfo}`);}else if(data.error==='Account deactivated'){showAlert('error','Your account has been deactivated. Please contact support to reactivate your account.');}else{showAlert('error',data.message||'You do not have permission to perform this checkout.');}}else if(((_error$response2=error.response)===null||_error$response2===void 0?void 0:_error$response2.status)===422){const errorData=error.response.data;if(errorData.errors){const firstError=Object.values(errorData.errors)[0];const errorMessage=Array.isArray(firstError)?firstError[0]:firstError;showAlert('error',`Validation Error: ${errorMessage}`);}else{showAlert('error',errorData.message||'Please check your input and try again.');}}else if(((_error$response3=error.response)===null||_error$response3===void 0?void 0:_error$response3.status)===400){showAlert('error',error.response.data.message||'Invalid checkout request. Please check your items and try again.');}else if(!error.response){showAlert('error','Network error. Please check your internet connection and try again.');}else{showAlert('error','Checkout failed. Please try again or contact support if the problem persists.');}}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"page-container\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"login-back-button\",onClick:()=>navigate('/rental-section'),children:/*#__PURE__*/_jsx(ArrowLeftIcon,{className:\"login-back-icon\"})}),alert.show&&/*#__PURE__*/_jsx(AlertMessage,{type:alert.type,message:alert.message,onClose:()=>setAlert({show:false,type:'',message:''}),className:\"fixed-alert\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"main-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"left-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card item-card\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"item-rented-title\",children:\"Item Rented\"}),rentedItems.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"empty-message\",children:\"No rented items yet.\"}):rentedItems.map(item=>{// Improved image logic: only use real backend images, otherwise show default\nlet imageUrl='/default-rental-image.jpg';if(item.images_url&&Array.isArray(item.images_url)&&item.images_url.length>0){const img=item.images_url[0];if(img.startsWith('http'))imageUrl=img;else if(img.startsWith('/storage/'))imageUrl=`http://localhost:8000${img}`;else if(img.startsWith('rentals/'))imageUrl=`http://localhost:8000/storage/${img}`;else imageUrl='/default-rental-image.jpg';}else if(item.image_url){if(item.image_url.startsWith('http'))imageUrl=item.image_url;else if(item.image_url.startsWith('/storage/'))imageUrl=`http://localhost:8000${item.image_url}`;else if(item.image_url.startsWith('rentals/'))imageUrl=`http://localhost:8000/storage/${item.image_url}`;else imageUrl='/default-rental-image.jpg';}else if(item.image){if(item.image.startsWith('http'))imageUrl=item.image;else if(item.image.startsWith('data:image/'))imageUrl=item.image;else if(item.image.startsWith('/storage/'))imageUrl=`http://localhost:8000${item.image}`;else if(item.image.startsWith('rentals/'))imageUrl=`http://localhost:8000/storage/${item.image}`;else imageUrl='/default-rental-image.jpg';}console.log('Checkout image debug:',{item,imageUrl});return/*#__PURE__*/_jsxs(\"div\",{className:\"rented-item enhanced-rented-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"enhanced-image-wrapper\",children:/*#__PURE__*/_jsx(SafeImage,{src:imageUrl,alt:item.name,className:\"enhanced-checkout-item-image\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"enhanced-item-details\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"enhanced-item-title\",children:item.name}),/*#__PURE__*/_jsx(\"div\",{className:\"enhanced-price-info\",children:/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u20B1\",item.price.toFixed(2)]})}),/*#__PURE__*/_jsx(\"button\",{className:\"remove-button\",onClick:()=>removeItem(item.id),children:\"Remove\"})]})]},item.id);})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card form-card\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"section-title\",children:\"Renter Information\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"input-form\",onSubmit:e=>e.preventDefault(),children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"name\",placeholder:\"Name*\",value:formData.name,onChange:handleInputChange,required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"contactNumber\",placeholder:\"Contact Number*\",value:formData.contactNumber,onChange:handleInputChange,required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"rentDuration\",placeholder:\"Rent Duration*\",value:formData.rentDuration,onChange:handleInputChange,required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"message\",placeholder:\"Message (optional)\",value:formData.message,onChange:handleInputChange})]}),isLoggedIn&&user&&/*#__PURE__*/_jsx(\"p\",{className:\"auto-fill-notice\",children:\"\\u2713 Name and contact information auto-filled from your profile\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"right-section\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card summary-card\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"section-title\",children:\"Rental Summary\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-details\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"summary-row\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Sub Total\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u20B1\",subTotal.toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-row\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Platform Fee\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u20B1\",platformFee.toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-row total\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Total\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u20B1\",total.toFixed(2)]})]})]}),/*#__PURE__*/_jsx(\"h3\",{className:\"section-subtitle\",children:\"Payment Method\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"payment-options\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"payment-option\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"payment\",value:\"cash_on_delivery\",checked:formData.paymentMethod==='cash_on_delivery',onChange:handlePaymentMethodChange}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Cash on Delivery\"}),/*#__PURE__*/_jsx(\"p\",{style:{fontSize:'12px',color:'#666',margin:'2px 0 0 0'},children:\"Payment pending - Requires owner approval before earning\"})]})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"payment-option\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"payment\",value:\"gcash\",checked:formData.paymentMethod==='gcash',onChange:handlePaymentMethodChange}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"GCash\"}),/*#__PURE__*/_jsx(\"p\",{style:{fontSize:'12px',color:'#059669',margin:'2px 0 0 0'},children:\"\\u2713 Pay using GCash number shown in item details\"})]})]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"primary-button\",onClick:handleCompleteRental,disabled:loading||rentedItems.length===0,children:loading?'Processing...':'Complete Rental'})]})})]}),showModal&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back-button\",onClick:closeModal,children:/*#__PURE__*/_jsx(ArrowLeftIcon,{className:\"back-icon\"})}),/*#__PURE__*/_jsx(\"h3\",{children:\"Confirm Rental\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-details\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Renter:\"}),\" \",formData.name]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Contact:\"}),\" \",formData.contactNumber]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Duration:\"}),\" \",formData.rentDuration]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Payment Method:\"}),\" \",formData.paymentMethod==='cash_on_delivery'?'Cash on Delivery':'GCash']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Total Amount:\"}),\" \\u20B1\",total.toFixed(2)]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Items:\"}),\" \",rentedItems.length,\" item(s)\"]}),formData.paymentMethod==='gcash'&&/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'12px',padding:'12px',background:'#f0f9ff',borderRadius:'8px',border:'1px solid #bfdbfe'},children:/*#__PURE__*/_jsxs(\"p\",{style:{margin:'0',fontSize:'14px',color:'#1e40af'},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Note:\"}),\" For GCash payment, use the GCash number shown in the item details. After payment, contact the owner to confirm the transaction.\"]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"confirm-button\",onClick:confirmRental,disabled:loading,children:loading?'Processing...':'Confirm'}),/*#__PURE__*/_jsx(\"button\",{className:\"cancel-button\",onClick:closeModal,children:\"Cancel\"})]})]})})]});};export default Checkout;","map":{"version":3,"names":["useState","useEffect","useNavigate","useLocation","ArrowLeftIcon","useAuth","rentalAPI","AlertMessage","SafeImage","jsx","_jsx","jsxs","_jsxs","hasRealImage","item","images_url","Array","isArray","length","image_url","image","Checkout","navigate","location","user","isLoggedIn","rentedItems","setRentedItems","showModal","setShowModal","loading","setLoading","alert","setAlert","show","type","message","formData","setFormData","name","contactNumber","rentDuration","paymentMethod","showAlert","setTimeout","_location$state","storedItems","JSON","parse","localStorage","getItem","passedRental","state","rental","initialItems","rentalItem","id","title","price","parseFloat","console","log","existingItemIndex","findIndex","setItem","stringify","prev","contact_number","fetchMissingImages","updatedItems","Promise","all","map","res","getRental","data","e","some","handleInputChange","value","target","handlePaymentMethodChange","removeItem","filter","subTotal","reduce","acc","platformFee","total","handleCompleteRental","trim","closeModal","confirmRental","checkoutData","items","renter_name","renter_email","email","rent_duration","payment_method","renter_id","response","checkout","success","earnings_updated","total_amount","toFixed","error","_error$response","_error$response2","_error$response3","status","_error$restrictionDet","restrictionDetails","details","restriction_details","actionMessage","blocked_action","blockedAction","contactInfo","contact_info","errorData","errors","firstError","Object","values","errorMessage","className","children","onClick","onClose","imageUrl","img","startsWith","src","alt","onSubmit","preventDefault","placeholder","onChange","required","checked","style","fontSize","color","margin","disabled","marginTop","padding","background","borderRadius","border"],"sources":["C:/Users/Acer/Downloads/Clients/hulame/front/src/Components/CheckoutSection/Checkout.jsx"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport './Checkout.css';\nimport { ArrowLeftIcon } from '@heroicons/react/24/solid';\nimport { useAuth } from '../../Context/AuthContext';\nimport { rentalAPI } from '../../services/api';\nimport AlertMessage from '../Common/AlertMessage';\nimport SafeImage from '../Common/SafeImage';\n\n// Helper to check if item has real image data\nconst hasRealImage = (item) => {\n  if (item.images_url && Array.isArray(item.images_url) && item.images_url.length > 0) return true;\n  if (item.image_url) return true;\n  if (item.image) return true;\n  return false;\n};\n\nconst Checkout = () => {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const { user, isLoggedIn } = useAuth();\n  const [rentedItems, setRentedItems] = useState([]);\n  const [showModal, setShowModal] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [alert, setAlert] = useState({ show: false, type: '', message: '' });\n  \n  // Form state\n  const [formData, setFormData] = useState({\n    name: '',\n    contactNumber: '',\n    rentDuration: '',\n    message: '',\n    paymentMethod: 'cash_on_delivery'\n  });\n\n  const showAlert = (type, message) => {\n    setAlert({ show: true, type, message });\n    setTimeout(() => setAlert({ show: false, type: '', message: '' }), 5000);\n  };\n\n  useEffect(() => {\n    const storedItems = JSON.parse(localStorage.getItem('rentedItems')) || [];\n    \n    // Check if there's a rental item passed via router state\n    const passedRental = location.state?.rental;\n    \n    let initialItems = storedItems;\n    \n    if (passedRental) {\n      // Preserve all image fields for robust image display\n      const rentalItem = {\n        ...passedRental, // keep all fields including images_url, image_url, image\n        id: passedRental.id,\n        name: passedRental.title,\n        price: parseFloat(passedRental.price)\n      };\n      \n      console.log('Adding rental item to cart:', rentalItem); // Debug log\n      \n      // Check if item is already in cart\n      const existingItemIndex = storedItems.findIndex(item => item.id === rentalItem.id);\n      \n      if (existingItemIndex === -1) {\n        // Add new item to cart\n        initialItems = [...storedItems, rentalItem];\n        localStorage.setItem('rentedItems', JSON.stringify(initialItems));\n        console.log('Item added to cart. Total items:', initialItems.length); // Debug log\n      } else {\n        // Item already exists, just set the stored items\n        initialItems = storedItems;\n        console.log('Item already in cart'); // Debug log\n      }\n    } else {\n      initialItems = storedItems;\n      console.log('No rental passed via state. Using stored items:', storedItems.length); // Debug log\n    }\n    \n    setRentedItems(initialItems);\n    \n    // Auto-fill user information if logged in\n    if (isLoggedIn && user) {\n      setFormData(prev => ({\n        ...prev,\n        name: user.name || '',\n        contactNumber: user.contact_number || ''\n      }));\n    }\n    \n    // Fetch latest rental data for each item if missing image fields\n    const fetchMissingImages = async () => {\n      const updatedItems = await Promise.all(initialItems.map(async (item) => {\n        if (hasRealImage(item)) return item;\n        try {\n          const res = await rentalAPI.getRental(item.id);\n          console.log('Fetched rental from API:', res.data);\n          // Merge the latest data into the item\n          return { ...item, ...res.data.data };\n        } catch (e) {\n          return item;\n        }\n      }));\n      setRentedItems(updatedItems);\n      localStorage.setItem('rentedItems', JSON.stringify(updatedItems));\n    };\n    if (initialItems.some(item => !hasRealImage(item))) {\n      fetchMissingImages();\n    }\n  }, [isLoggedIn, user, location.state]);\n\n  const handleInputChange = (e) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({\n      ...prev,\n      [name]: value\n    }));\n  };\n\n  const handlePaymentMethodChange = (e) => {\n    setFormData(prev => ({\n      ...prev,\n      paymentMethod: e.target.value\n    }));\n  };\n\n  const removeItem = (id) => {\n    const updatedItems = rentedItems.filter((item) => item.id !== id);\n    setRentedItems(updatedItems);\n    localStorage.setItem('rentedItems', JSON.stringify(updatedItems));\n  };\n\n  const subTotal = rentedItems.reduce((acc, item) => acc + item.price, 0);\n  const platformFee = 10;\n  const total = subTotal + platformFee;\n\n  const handleCompleteRental = () => {\n    // Validate form\n    if (!formData.name.trim()) {\n      showAlert('error', 'Please enter your name');\n      return;\n    }\n    if (!formData.contactNumber.trim()) {\n      showAlert('error', 'Please enter your contact number');\n      return;\n    }\n    if (!formData.rentDuration.trim()) {\n      showAlert('error', 'Please enter rent duration');\n      return;\n    }\n    if (rentedItems.length === 0) {\n      showAlert('error', 'No items in cart');\n      return;\n    }\n    \n    setShowModal(true);\n  };\n  \n  const closeModal = () => setShowModal(false);\n\n  const confirmRental = async () => {\n    setLoading(true);\n    try {\n      const checkoutData = {\n        items: rentedItems.map(item => ({\n          id: item.id,\n          name: item.name,\n          price: item.price\n        })),\n        renter_name: formData.name,\n        renter_email: user?.email || 'guest@example.com',\n        contact_number: formData.contactNumber,\n        rent_duration: formData.rentDuration,\n        message: formData.message,\n        payment_method: formData.paymentMethod,\n        renter_id: user?.id || null\n      };\n\n      const response = await rentalAPI.checkout(checkoutData);\n      \n      if (response.data.success) {\n        const { data } = response.data;\n        \n        if (data.earnings_updated) {\n          showAlert('success', `Payment successful! Total: ₱${data.total_amount.toFixed(2)}\\n\\nYour earnings have been updated immediately. Check your earnings page to see the new balance.`);\n        } else {\n          showAlert('success', `Checkout successful! Total: ₱${data.total_amount.toFixed(2)}\\n\\nYour rental request has been sent. You'll earn money once the owner approves and completes the transaction.`);\n        }\n        \n        // Clear cart and form\n        setRentedItems([]);\n        localStorage.removeItem('rentedItems');\n        setFormData({\n          name: user?.name || '',\n          contactNumber: user?.contact_number || '',\n          rentDuration: '',\n          message: '',\n          paymentMethod: 'cash_on_delivery'\n        });\n        setShowModal(false);\n        \n        // Navigate to earnings page if payment was completed\n        setTimeout(() => {\n          if (data.earnings_updated) {\n            navigate('/rentals');\n          } else {\n            navigate('/rentals');\n          }\n        }, 3000);\n      }\n    } catch (error) {\n      console.error('Checkout error:', error);\n      \n      // Handle different types of errors with detailed messages\n      if (error.response?.status === 403) {\n        const data = error.response.data;\n        \n        // Handle suspended account with detailed restrictions\n        if (data.error === 'Account suspended' || error.restrictionDetails?.type === 'suspended') {\n          const details = error.restrictionDetails || data.restriction_details || {};\n          const actionMessage = details.blocked_action || details.blockedAction || 'checking out items';\n          const contactInfo = details.contact_info || details.contactInfo || 'Please contact support for assistance.';\n          \n          showAlert('error', \n            `Account Suspended: You cannot perform this action (${actionMessage}). ${contactInfo}`\n          );\n        } else if (data.error === 'Account deactivated') {\n          showAlert('error', 'Your account has been deactivated. Please contact support to reactivate your account.');\n        } else {\n          showAlert('error', data.message || 'You do not have permission to perform this checkout.');\n        }\n      } else if (error.response?.status === 422) {\n        const errorData = error.response.data;\n        if (errorData.errors) {\n          const firstError = Object.values(errorData.errors)[0];\n          const errorMessage = Array.isArray(firstError) ? firstError[0] : firstError;\n          showAlert('error', `Validation Error: ${errorMessage}`);\n        } else {\n          showAlert('error', errorData.message || 'Please check your input and try again.');\n        }\n      } else if (error.response?.status === 400) {\n        showAlert('error', error.response.data.message || 'Invalid checkout request. Please check your items and try again.');\n      } else if (!error.response) {\n        showAlert('error', 'Network error. Please check your internet connection and try again.');\n      } else {\n        showAlert('error', 'Checkout failed. Please try again or contact support if the problem persists.');\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"page-container\">\n      <button className=\"login-back-button\" onClick={() => navigate('/rental-section')}>\n        <ArrowLeftIcon className=\"login-back-icon\" />\n      </button>\n\n      {alert.show && (\n        <AlertMessage \n          type={alert.type} \n          message={alert.message} \n          onClose={() => setAlert({ show: false, type: '', message: '' })}\n          className=\"fixed-alert\"\n        />\n      )}\n\n      <div className=\"main-content\">\n        <div className=\"left-section\">\n          <div className=\"card item-card\">\n            <h2 className=\"item-rented-title\">Item Rented</h2>\n            {rentedItems.length === 0 ? (\n              <p className=\"empty-message\">No rented items yet.</p>\n            ) : (\n              rentedItems.map((item) => {\n                // Improved image logic: only use real backend images, otherwise show default\n                let imageUrl = '/default-rental-image.jpg';\n                if (item.images_url && Array.isArray(item.images_url) && item.images_url.length > 0) {\n                  const img = item.images_url[0];\n                  if (img.startsWith('http')) imageUrl = img;\n                  else if (img.startsWith('/storage/')) imageUrl = `http://localhost:8000${img}`;\n                  else if (img.startsWith('rentals/')) imageUrl = `http://localhost:8000/storage/${img}`;\n                  else imageUrl = '/default-rental-image.jpg';\n                } else if (item.image_url) {\n                  if (item.image_url.startsWith('http')) imageUrl = item.image_url;\n                  else if (item.image_url.startsWith('/storage/')) imageUrl = `http://localhost:8000${item.image_url}`;\n                  else if (item.image_url.startsWith('rentals/')) imageUrl = `http://localhost:8000/storage/${item.image_url}`;\n                  else imageUrl = '/default-rental-image.jpg';\n                } else if (item.image) {\n                  if (item.image.startsWith('http')) imageUrl = item.image;\n                  else if (item.image.startsWith('data:image/')) imageUrl = item.image;\n                  else if (item.image.startsWith('/storage/')) imageUrl = `http://localhost:8000${item.image}`;\n                  else if (item.image.startsWith('rentals/')) imageUrl = `http://localhost:8000/storage/${item.image}`;\n                  else imageUrl = '/default-rental-image.jpg';\n                }\n                console.log('Checkout image debug:', {item, imageUrl});\n                return (\n                  <div key={item.id} className=\"rented-item enhanced-rented-item\">\n                    <div className=\"enhanced-image-wrapper\">\n                      <SafeImage \n                        src={imageUrl} \n                        alt={item.name}\n                        className=\"enhanced-checkout-item-image\"\n                      />\n                    </div>\n                    <div className=\"enhanced-item-details\">\n                      <div className=\"enhanced-item-title\">{item.name}</div>\n                      <div className=\"enhanced-price-info\">\n                        <span>₱{item.price.toFixed(2)}</span>\n                      </div>\n                      <button className=\"remove-button\" onClick={() => removeItem(item.id)}>\n                        Remove\n                      </button>\n                    </div>\n                  </div>\n                );\n              })\n            )}\n          </div>\n\n          <div className=\"card form-card\">\n            <h2 className=\"section-title\">Renter Information</h2>\n            <form className=\"input-form\" onSubmit={(e) => e.preventDefault()}>\n              <input \n                type=\"text\" \n                name=\"name\"\n                placeholder=\"Name*\" \n                value={formData.name}\n                onChange={handleInputChange}\n                required \n              />\n              <input \n                type=\"text\" \n                name=\"contactNumber\"\n                placeholder=\"Contact Number*\" \n                value={formData.contactNumber}\n                onChange={handleInputChange}\n                required \n              />\n              <input \n                type=\"text\" \n                name=\"rentDuration\"\n                placeholder=\"Rent Duration*\" \n                value={formData.rentDuration}\n                onChange={handleInputChange}\n                required \n              />\n              <input \n                type=\"text\" \n                name=\"message\"\n                placeholder=\"Message (optional)\" \n                value={formData.message}\n                onChange={handleInputChange}\n              />\n            </form>\n            {isLoggedIn && user && (\n              <p className=\"auto-fill-notice\">\n                ✓ Name and contact information auto-filled from your profile\n              </p>\n            )}\n          </div>\n        </div>\n\n        <div className=\"right-section\">\n          <div className=\"card summary-card\">\n            <h2 className=\"section-title\">Rental Summary</h2>\n            <div className=\"summary-details\">\n              <div className=\"summary-row\">\n                <span>Sub Total</span>\n                <span>₱{subTotal.toFixed(2)}</span>\n              </div>\n              <div className=\"summary-row\">\n                <span>Platform Fee</span>\n                <span>₱{platformFee.toFixed(2)}</span>\n              </div>\n              <div className=\"summary-row total\">\n                <span>Total</span>\n                <span>₱{total.toFixed(2)}</span>\n              </div>\n            </div>\n\n            <h3 className=\"section-subtitle\">Payment Method</h3>\n            <div className=\"payment-options\">\n              <label className=\"payment-option\">\n                <input \n                  type=\"radio\" \n                  name=\"payment\" \n                  value=\"cash_on_delivery\"\n                  checked={formData.paymentMethod === 'cash_on_delivery'}\n                  onChange={handlePaymentMethodChange}\n                />\n                <div>\n                  <strong>Cash on Delivery</strong>\n                  <p style={{ fontSize: '12px', color: '#666', margin: '2px 0 0 0' }}>\n                    Payment pending - Requires owner approval before earning\n                  </p>\n                </div>\n              </label>\n              <label className=\"payment-option\">\n                <input \n                  type=\"radio\" \n                  name=\"payment\" \n                  value=\"gcash\"\n                  checked={formData.paymentMethod === 'gcash'}\n                  onChange={handlePaymentMethodChange}\n                />\n                <div>\n                  <strong>GCash</strong>\n                  <p style={{ fontSize: '12px', color: '#059669', margin: '2px 0 0 0' }}>\n                    ✓ Pay using GCash number shown in item details\n                  </p>\n                </div>\n              </label>\n            </div>\n\n            <button \n              className=\"primary-button\" \n              onClick={handleCompleteRental}\n              disabled={loading || rentedItems.length === 0}\n            >\n              {loading ? 'Processing...' : 'Complete Rental'}\n            </button>\n          </div>\n        </div>\n      </div>\n\n      {showModal && (\n        <div className=\"modal-overlay\">\n          <div className=\"modal-content\">\n            <button className=\"back-button\" onClick={closeModal}>\n              <ArrowLeftIcon className=\"back-icon\" />\n            </button>\n            <h3>Confirm Rental</h3>\n            <div className=\"modal-details\">\n              <p><strong>Renter:</strong> {formData.name}</p>\n              <p><strong>Contact:</strong> {formData.contactNumber}</p>\n              <p><strong>Duration:</strong> {formData.rentDuration}</p>\n              <p><strong>Payment Method:</strong> {formData.paymentMethod === 'cash_on_delivery' ? 'Cash on Delivery' : 'GCash'}</p>\n              <p><strong>Total Amount:</strong> ₱{total.toFixed(2)}</p>\n              <p><strong>Items:</strong> {rentedItems.length} item(s)</p>\n              {formData.paymentMethod === 'gcash' && (\n                <div style={{ marginTop: '12px', padding: '12px', background: '#f0f9ff', borderRadius: '8px', border: '1px solid #bfdbfe' }}>\n                  <p style={{ margin: '0', fontSize: '14px', color: '#1e40af' }}>\n                    <strong>Note:</strong> For GCash payment, use the GCash number shown in the item details. \n                    After payment, contact the owner to confirm the transaction.\n                  </p>\n                </div>\n              )}\n            </div>\n            <div className=\"modal-buttons\">\n              <button \n                className=\"confirm-button\" \n                onClick={confirmRental}\n                disabled={loading}\n              >\n                {loading ? 'Processing...' : 'Confirm'}\n              </button>\n              <button className=\"cancel-button\" onClick={closeModal}>\n                Cancel\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Checkout;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}